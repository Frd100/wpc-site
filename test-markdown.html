<!DOCTYPE html>
<html>

<head>
    <title>Test Markdown Parser</title>
</head>

<body>
    <h1>Test du parseur Markdown</h1>
    <div id="result"></div>

    <script>
        // Copie de votre fonction markdownToHtml corrigée
        function markdownToHtml(markdown) {
            let html = markdown;

            // Traitement des paragraphes d'abord (avant de casser avec split)
            html = html.split('\n\n').map(para => {
                para = para.trim();
                if (!para) return '';

                // Titres
                if (para.match(/^### /)) {
                    return para.replace(/^### (.*$)/gim, '<h3>$1</h3>');
                }
                if (para.match(/^## /)) {
                    return para.replace(/^## (.*$)/gim, '<h2>$1</h2>');
                }
                if (para.match(/^# /)) {
                    return para.replace(/^# (.*$)/gim, '<h1>$1</h1>');
                }

                // Séparateurs
                if (para.match(/^---$/)) {
                    return para.replace(/^---$/gim, '<hr>');
                }

                // Listes non ordonnées
                if (para.match(/^\- /)) {
                    const listItems = para.split('\n').map(item => {
                        if (item.match(/^\- /)) {
                            return item.replace(/^\- (.+)$/gim, '<li>$1</li>');
                        }
                        return item;
                    }).join('');
                    return `<ul>${listItems}</ul>`;
                }

                // Pour les autres paragraphes, traiter le contenu inline
                let processedPara = para;

                // Images Markdown
                processedPara = processedPara.replace(/!\[(.*?)\]\((.*?)\)/g, '<img src="$2" alt="$1" style="max-width:100%;height:auto;">');

                // Liens Markdown
                processedPara = processedPara.replace(/\[([^\]]+)\]\(([^\)]+)\)/g, '<a href="$2">$1</a>');

                // Gras et italique
                processedPara = processedPara.replace(/\*\*\*(.+?)\*\*\*/g, '<strong><em>$1</em></strong>');
                processedPara = processedPara.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
                processedPara = processedPara.replace(/\*(.+?)\*/g, '<em>$1</em>');

                return `<p>${processedPara}</p>`;
            }).join('\n');

            return html;
        }

        // Test avec le contenu de votre fichier
        const testContent = `Voici un test d'image :

![La Défense](/assets/images/ladefense.webp)

Et voici un lien : [Accueil](/index.html)

**Texte en gras** et *texte en italique*.

## Titre de section

- Liste à puces
- Deuxième élément`;

        document.getElementById('result').innerHTML = markdownToHtml(testContent);
    </script>
</body>

</html>